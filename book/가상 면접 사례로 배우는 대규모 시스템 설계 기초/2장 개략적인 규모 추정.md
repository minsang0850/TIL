개략적인 규모 추정(back-of-the-envelope estimation)은 보편적으로 통용되는 성능 수치상에서 사고 실험(thought experiments)을 행하여 추정치를 계산하는 행위로서,
어떤 설계가 요구사항에 부합할 것인지 보기 위한 것이다.

## 2의 제곱수
2의 제곱수
- 10제곱: 1천, 1킬로바이트
- 20제곱: 1백만, 1메가바이트
- 30제곱: 10억, 1기가바이트
- 40제곱: 1조, 1테라바이트
- 50제곱: 1000조, 1페타바이트

## 모든 프로그래머가 알아야 하는 응답지연 값
- L1 캐시 참조: 0.5ns
- 분기 예측 오류(branch mispredict): 5ns
- L2 캐시 참조: 7ns
- 뮤텍스(mutex) 락/언락: 100ns
- 주 메모리 참조: 100ns
- Zippy로 1KB 압축: 10,000ns
- 1Gbps 네트워크로 2KB 전송: 20,000ns
- 메모리에서 1MB 순차적으로 read: 250,000 ns
- 같은 데이터 센터 내에서의 메시지 왕복 지연 시간: 500,000ns
- 디스크 탐색(seek): 10ms
- 네트워크에서 1MB 순차적으로 read: 10ms
- 디스크에서 1MB 순차적으로 read: 30ms
- 한 패킷의 캘리포니아부터 네덜란드까지의 왕복 지연시간: 150ms

**분석**  
- 메모리는 빠르지만 디스크는 아직도 느리다
- 디스크 탐색(seek)은 가능한 한 피하라
- 단순한 압축 알고리즘은 빠르다
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들
고가용성(high availability)은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어다.
고가용성을 표현하는 값은 퍼센트로 표현하는데, 100%는 시스템이 단 한 번도 중단된 적이 없었음을 의미한다.
대부분의 서비스는 99%에서 100% 사이의 값을 갖는다.

SLA(Servie Level Agreement)는 서비스 사업자가 보편적으로 사용하는 용어로, 서비스 사업자와 고객 사이에 맺어진 합의를 의미한다.

## 예제: 트위터 QPS와 저장소 요구량 추정
연습용 -> 실제 아님

**가정**  
- 월간 능동 사용자는 3억명
- 50%의 사용자가 트위터를 매일 사용
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10% 정도다.
- 데이터는 5년간 보관된다.

**추정**  
**QPS(Query Per Second) 추정치**
- 일간 능동 사용자 = 3억 * 50% = 1.5억
- QPS = 1.5억 * 2 트윗 / 24시간 / 3600초 = 약 3500
- 최대 QPS(Peek QPS) = 2 * QPS = 약 7000

**미디어 저장을 위한 저장소 요구량**  
- 평균 트윗 크기
  - tweet_id에 64 바이트
  - 텍스트에 140 바이트
  - 미디어에 1MB
- 미디어 저장소 요구량: 1.5억 * 2 * 10% * 1MB = 30TB/일
- 5년간 미디어를 보관하기 위한 요구량: 30TB * 365 * 5 = 약 55PB

## 팁
중요한 것은 문제를 풀어 나가는 절차다.
- 근사치를 활용한 계산
- 가정(assumption)들은 적어두라. 나중에 살펴볼 수 있또록
- 단위(unit)를 붙이라.
- 많이 출제되는 개략적 규모 추정 문제는 QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 것이다.

