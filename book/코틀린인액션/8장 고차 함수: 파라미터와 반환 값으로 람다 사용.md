# 8.1 고차 함수 정의
고차 함수는 다른 함수를 인자로 받거나 함수를 반환하는 함수다.

표준 라이브러리 함수인 filter는 술어 함수를 인자로 받으므로 고차 함수다.

## 8.1.1 함수 타입
함수 타입을 정의하려면 함수 파라미터의 타입을 괄호 안에 넣고, 그 뒤에 화살표를 추가한 다음, 함수의 반환 타입을 지정하면 된다.
(Int, String) -> Unit
함수 타입을 선언할 때는 반환 타입을 반드시 명시해야 한다.

널이 될 수 있는 함수 타입 변수를 정의할 수도 있다.

## 8.1.2 인자로 받은 함수 호출

## 8.1.3 자바에서 코틀린 함수 타입 사용
함수 타입 변수는 FunctionN 인터페이스를 구현하는 객체를 저장한다.
코틀린 표준 라이브러리는 함수 인자의 개수에 따라 Function0<R>(인자가 없는 함수), Function<P1, R>(인자가 하나인 함수) 등의 인터페이스를 제공한다.
각 인터페이스에는 invoke 메서드 정의가 하나 들어 있다. invoke를 호출하면 함수를 실행할 수 있다.

## 8.1.4 디폴트 값을 지정한 함수 타입 파라미터나 널이 될 수 있는 함수 타입 파라미터
파라미터를 함수 타입으로 선언할 때도 디폴트 값을 정할 수 있다.

## 8.1.5 함수를 함수에서 반환

## 8.1.6 람다를 활용한 중복 제거
코드 중복을 줄일 때 함수 탕비이 상당히 도움이 된다.

# 8.2 인라인 함수: 람다의 부가 비용 없애기
람다는 동일한 함수 코드보다 덜 효율적이다.
그렇다면 반복되는 코드를 별도의 라이브러리 함수로 빼내되 컴파일러가 자바의 일반 명령문만큼 효율적인 코드를 생성하게 만들 수는 없을까?

inline 변경자를 어떤 함수에 붙이면 컴파일러는 그 함수를 호출하는 모든 문장을 함수 본문에 해당하는 바이트 코드로 바꿔치기 해준다.

## 8.2.1 인라이닝이 작동하는 방식
람다의 본문에 의해 만들어지는 바이트코드는 그 람다를 호출하는 코드 정의의 일부분으로 간주되기 때문에 코틀린 컴파일러는 그 람다를 함수 인터페이스를 구현하는 무명 클래스로 감싸지 않는다.

## 8.2.2 인라인 함수의 한계
함수가 인라이닝될 때 그 함수에 인자로 전달된 람다 식의 본문은 결과 코드에 직접 들어갈 수 있다.
하지만 이렇게 람다가 본문에 직접 펼쳐지기 때문에 함수가 파라미터로 전달받은 람다를 본문에 사용하는 방식이 한정될 수밖에 없다.

noinline 변경자를 파라미터 이름 앞에 붙여서 인라이닝을 금지할 수 있다.

## 8.2.3 컬렉션 연산 인라이닝
코틀린 표준 라이브러리의 컬렉션 함수는 대부분 람다를 인자로 받는다.

코틀린의 filter는 인라인 함수다.
따라서 filter 함수의 바이트 코드는 그 함수에 전달된 람다 본문의 바이트코드와 함께 filter를 호출한 위치에 들어간다.

시퀀스 연산에서는 람다가 인라이닝되지 않기 때문에 크기가 작은 컬렉션은 오히려 일반 컬렉션 연산이 더 성능이 나을 수 있다.

## 8.2.4 함수를 인라인으로 선언해야 하는 경우
...

## 8.2.5 자원 관리를 위해 인라인된 람다 사용
람다로 중복을 없앨 수 있는 일반적인 패턴 중 한 가지는 자원 관리다.

try-with-resource -> use
use는 closeable 자원에 대한 확장 함수며, 람다를 인자로 받는다.

# 8.3 고차 함수 안에서 흐름 제어
## 8.3.1 람다 안의 return문: 람다를 둘러싼 함수로부터 반환
람다 안에서 return을 사용하면 람다로부터만 반환되는 게 아니라 그 람다를 호출하는 함수가 실행을 끝내고 반환된다.
그렇게 자신을 감싸고 있는 블록보다 더 바깥에 있는 다른 블록을 반환하게 만드는 return 문을 넌로컬non-local return이라 부른다.

인라이닝되지 않는 함수에 전달되는 람다 안에서 return을 사용할 수는 없다.

## 8.3.2 람다로부터 반환: 레이블을 사용한 return
람다 식 앞에 label을 붙이고 return@label

람다를 인자로 받는 인라인 함수의 이름을 return 뒤에 레이블로 사용해도 된다.

## 8.3.3 무명 함수: 기본적으로 로컬 return
무명 함수 안에서 레이블이 붙지 않은 return 식은 무명 함수 자체를 반환시킬 뿐 무명 함수를 둘러싼 다른 함수를 반환시키지 않는다.

